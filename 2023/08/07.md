## 取り組んだ課題一覧
- Node.js IV
- Node.js V
- Node.js VI
## わかったこと
- デバッグとはバグの原因を見つけて、そのバグを直すこと
- 手順は①エラーの内容を把握②原因を予想③予想を順に確認
- ページにアクセスしたときエラーが起きると、ターミナルにエラーの原因箇所とその原因が表示される
- SQLクエリを実行した時のエラーをerrorに入るので、これを出力すると情報を見ることができる
- デバッグで使用したConsole.logは不要になったらすぐに消す
- 必要のない情報がターミナルに表示されエラー原因がわかりにくくなる
- ログイン機能の構成は①ログインフォームからフォーム送信②Node.jsでユーザーの特定と確認③認証したユーザーのアクセス管理
- セッション管理(認証したユーザーのアクセス管理)にはセッションID(SID)を用いる
- セッションを管理するための機能を提供してくれるexpress-sessionパッケージをインストールする
- req.session.プロパティ名=値でセッション情報に値を保存できる
- 呼び出すときはreq.session.プロパティ名
- サーバーはリクエストに一致するルーティングをapp.jsのものを上から順に探して実行する
- app.use関数は全てのリクエストに対応するため、ルーティング処理の一番最初に書くことで、毎回実行することができる
- 受け取ることのできる引数はreq, res, nextの3つ
- nextは処理の中で関数として使うことができる、next関数を実行するとリクエストに一致する次の処理を実行する
- app.useからEJSファイルに値を渡すときはres.localsに値を入れる
- res.locals.プロパティ名 = 値 で代入、代入した値はレスポンスを返すまで使用可能
- EJSファイルではlocalsオブジェクトに変換、locals.プロパティ名で値を用いる、resはつかない
- EJSにはファイルの中で、別のEJSファイルを呼び出すinclude機能がある
- ある機能はひとつのEJSにまとめて、それを呼び出して使用することでひとつのファイルでその機能を管理できる
- 別のEJSファイルを呼び出すときは<%- include('ファイル名'); %>、ファイル名の.ejsは省略可
- ログアウトはセッション情報を削除する
- req.session.destroy( ()=>{ 実行後の処理 }) でセッション情報を削除する
- req.session.destroyの引数errorには削除処理が失敗したときの情報が入る
- ログインしているかどうかのセッション情報をres.localsに渡す
- INSERTクエリが成功すると、特に設定しなくても、追加したレコードのidがresultsオブジェクトのinsertIdというプロパティに入る
- ユーザーの入力値が空かどうかをチェックする機能をミドルウェア関数を用いて作成する
- Expressでは、リクエストとレスポンスの間にサーバーが実行する関数のことをミドルウェア関数とよぶ
- ルーティングに対応する処理を書いてきた関数がミドルウェア関数
- リクエストを受け取ってからレスポンスを返す間に、複数のミドルウェア関数をつくることができる
- カンマで区切って複数のミドルウェア関数を作る
- ミドルウェア関数は上から順に実行される、next();で次のミドルウェア関数に進む
- データをチェックする仕組みのことをバリデーションと呼ぶ
- パスワードの安全性を高めるためにハッシュ化してDBに保存する
- パスワードのハッシュ化はbcryptというパッケージを使う
- パスワードをハッシュ化するには、bcryptパッケージのhashメソッドを用いる
- bcrypt.hash("普通の文字列のパスワード",パスワードの強度数値,(error,hash)=>{});
- hashにハッシュ化されたパスワードが入る
- 普通の文字列とハッシュ化されたパスワードを比較するにはbcryptパッケージのcompareメソッドを使う
- bcrypt.compare("普通の文字列のパスワード","ハッシュ化されたパスワード",(error,isEqual)=>{比較した結果によって処理を変える});
- isEqualに比較結果が入る
## 次やること
- Markdownを使えるようにする
## 感じたこと
- Webアプリの作成方法は、RubyonRailsなどで学んだ部分が共通していた
- JavaScriptを用いたNode.jsのほうが馴染みやすい
- 約１か月でprogateを終えられた
- 次はアウトプットのための準備を進めていく
## 学習時間
- Today:4h Total:60.5h
